piece_shapes = "IJLOSTZ";

// block offsets go from root position, rotating clockwise.

var spawn_positions = {
	"I": {x: 5, y: 0},
	"J": {x: 4, y: 1},
	"L": {x: 4, y: 1},
	"O": {x: 5, y: 1},
	"S": {x: 4, y: 1},
	"T": {x: 4, y: 1},
	"Z": {x: 4, y: 1},
}

var block_offsets = {
    "I": [
		// [][]()[]
		[
	        {x: 0, y: 0},
	        {x: -1, y: 0},
	        {x: -2, y: 0},
	        {x: 1, y: 0}
		],
		// []
		// ()
		// []
		// []
		[
			{x: 0, y: 0},
	        {x: 0, y: -1},
	        {x: 0, y: 1},
	        {x: 0, y: 2}
		],
		// [][]()[]
		[
			{x: 0, y: 0},
			{x: -1, y: 0},
			{x: -2, y: 0},
			{x: 1, y: 0}
		],
		// []
		// []..
		// []
		// []
		[
			{x: -1, y: 0},
			{x: -1, y: -1},
			{x: -1, y: 1},
			{x: -1, y: 2}
		],
    ],
    "J": [
		// []
		// []()[]
		[
	        {x: 0, y: 0},
	        {x: -1, y: 0},
	        {x: 1, y: 0},
	        {x: -1, y: -1}
		],
		// [][]
		// []
		// ()
		[
			{x: 0, y: -1},
			{x: 1, y: -2},
			{x: 0, y: -2},
			{x: 0, y: 0}
		],
		// [][][]
		//   ..[]
		[
			{x: 0, y: -1},
	        {x: -1, y: -1},
	        {x: 1, y: -1},
	        {x: 1, y: 0}
		],
		//   []
		//   []
		// []()
		[
			{x: 0, y: -1},
			{x: 0, y: -2},
			{x: 0, y: 0},
			{x: -1, y: 0}
		],
    ],
    "L": [
		//     []
		// []()[]
		[
	        {x: 0, y: 0},
	        {x: -1, y: 0},
	        {x: 1, y: 0},
	        {x: 1, y: -1}
		],
		// []
		// []
		// ()[]
		[
			{x: 0, y: -2},
			{x: 0, y: -1},
			{x: 1, y: 0},
			{x: 0, y: 0},
		],
		// [][][]
		// []..
		[
			{x: 0, y: -1},
	        {x: -1, y: -1},
	        {x: 1, y: -1},
	        {x: -1, y: 0}
		],
		// [][]
		//   []
		//   ()
		[
			{x: 0, y: -1},
			{x: -1, y: -2},
			{x: 0, y: -2},
			{x: 0, y: 0}
		],
    ],
    "O": [
		// [][]
		// []()  The O piece never rotates.
		[
	        {x: 0, y: 0},
	        {x: -1, y: 0},
	        {x: -1, y: -1},
	        {x: 0, y: -1}
		],
		[
			{x: 0, y: 0},
			{x: -1, y: 0},
			{x: -1, y: -1},
			{x: 0, y: -1}
		],
		[
			{x: 0, y: 0},
			{x: -1, y: 0},
			{x: -1, y: -1},
			{x: 0, y: -1}
		],
		[
			{x: 0, y: 0},
			{x: -1, y: 0},
			{x: -1, y: -1},
			{x: 0, y: -1}
		],
    ],
    "S": [
		//   [][]
		// []()
		[
			{x: 1, y: -1},
	        {x: 0, y: -1},
	        {x: 0, y: 0},
	        {x: -1, y: 0}
		],
		// []
		// [][]
		//   ()
		[
			{x: -1, y: -2},
			{x: -1, y: -1},
			{x: 0, y: -1},
			{x: 0, y: 0}
		],
		//   [][]
		// []()
		[
			{x: 1, y: -1},
	        {x: 0, y: -1},
	        {x: 0, y: 0},
	        {x: -1, y: 0}
		],
		// []
		// [][]
		//   ()
		[
			{x: -1, y: -2},
			{x: -1, y: -1},
			{x: 0, y: -1},
			{x: 0, y: 0}
		],
    ],
    "T": [
		//   []
		// []()[]
		[
			{x: 0, y: 0},
			{x: -1, y: 0},
			{x: 1, y: 0},
			{x: 0, y: -1}
		],
		// []
		// [][]
		// ()
		[
			{x: 0, y: -1},
			{x: 0, y: 0},
			{x: 1, y: -1},
			{x: 0, y: -2}
		],
		// [][][]
		//   ()
		[
			{x: 0, y: -1},
			{x: -1, y: -1},
			{x: 1, y: -1},
			{x: 0, y: 0}
		],
		//   []
		// [][]
		//   ()
		[
			{x: 0, y: -1},
			{x: 0, y: 0},
			{x: -1, y: -1},
			{x: 0, y: -2}
		],
    ],
    "Z": [
		// [][]
		//   ()[]
		[
	        {x: 0, y: -1},
	        {x: -1, y: -1},
	        {x: 1, y: 0},
	        {x: 0, y: 0}
		],
		//   []
		// [][]
		// ()
		[
	        {x: 0, y: -1},
	        {x: 0, y: 0},
	        {x: 1, y: -2},
	        {x: 1, y: -1}
		],
		// [][]
		//   ()[]
		[
	        {x: 0, y: -1},
	        {x: -1, y: -1},
	        {x: 1, y: 0},
	        {x: 0, y: 0}
		],
		//   []
		// [][]
		// ()
		[
	        {x: 0, y: -1},
	        {x: 0, y: 0},
	        {x: 1, y: -2},
	        {x: 1, y: -1}
		],
    ]
};



// SRS-ish kick state

var kick_positions = {

    "I": {
        "10": [
        	{x: 0, y: 0}, {x: 1, y: 0}, {x: 2, y: 0}, {x: -1, y: 0}, {x: 0, y: 1}, {x: 0, y: -1},
        ],
        "21": [
            {x: 0, y: 0}, {x: 1, y: 0}, {x: -1, y: 0}, {x: 0, y: -1}, {x: 0, y: 1}, {x: 0, y: -2},
        ],
        "32": [
            {x: 0, y: 0}, {x: -1, y: 0}, {x: -2, y: 0}, {x: 1, y: 0}, {x: 0, y: 1}, {x: 0, y: -1},
        ],
        "03": [
            {x: 0, y: 0}, {x: -1, y: 0}, {x: 1, y: 0}, {x: 0, y: 1}, {x: 0, y: -1}, {x: 0, y: -2},
        ],
        "01": [
            {x: 0, y: 0}, {x: -1, y: 0}, {x: 1, y: 0}, {x: 0, y: -1}, {x: 0, y: 1}, {x: 0, y: -2},
        ],
        "12": [
            {x: 0, y: 0}, {x: -1, y: 0}, {x: -2, y: 0}, {x: 1, y: 0}, {x: 0, y: 1}, {x: 0, y: -1},
        ],
        "23": [
            {x: 0, y: 0}, {x: 1, y: 0}, {x: -1, y: 0}, {x: 0, y: 1}, {x: 0, y: -1}, {x: 0, y: -2},
        ],
        "30": [
            {x: 0, y: 0}, {x: 1, y: 0}, {x: 2, y: 0}, {x: -1, y: 0}, {x: 0, y: 1}, {x: 0, y: -1},
        ],
        // don't kick on half turns
        "02": [{x: 0, y: 0}],
        "20": [{x: 0, y: 0}],
        "13": [{x: 0, y: 0}],
        "31": [{x: 0, y: 0}],
    },


    "J": {
        "01": [
            {x: 0, y: 0}, {x: -1, y: 0}, {x: -1, y: -1}, {x: 0, y: 2}, {x: -1, y: 2},
        ],
        "12": [
            {x: 0, y: 0}, {x: 1, y: 0}, {x: 1, y: 1}, {x: 0, y: -2}, {x: 1, y: -2},
        ],
        "23": [
            {x: 0, y: 0}, {x: 1, y: 0}, {x: 1, y: -1}, {x: 0, y: 2}, {x: 1, y: 2},
        ],
        "30": [
            {x: 0, y: 0}, {x: -1, y: 0}, {x: -1, y: 1}, {x: 0, y: -2}, {x: -1, y: -2},
        ],

        "10": [
            {x: 0, y: 0}, {x: 1, y: 0}, {x: 1, y: 1}, {x: 0, y: -2}, {x: 1, y: -2},
        ],
        "21": [
            {x: 0, y: 0}, {x: -1, y: 0}, {x: -1, y: -1}, {x: 0, y: 2}, {x: -1, y: 2},
        ],
        "32": [
            {x: 0, y: 0}, {x: -1, y: 0}, {x: -1, y: 1}, {x: 0, y: -2}, {x: -1, y: -2},
        ],
        "03": [
            {x: 0, y: 0}, {x: 1, y: 0}, {x: 1, y: -1}, {x: 0, y: 2}, {x: 1, y: 2},
        ],
        "02": [{x: 0, y: 0}, {x: 0, y: 1}, {x: 0, y: -1}],
        "20": [{x: 0, y: 0}, {x: 0, y: 1}, {x: 0, y: -1}],
        "13": [{x: 0, y: 0}, {x: 0, y: 1}, {x: 0, y: -1}],
        "31": [{x: 0, y: 0}, {x: 0, y: 1}, {x: 0, y: -1}],

    },

    "L": {
        "01": [
            {x: 0, y: 0}, {x: -1, y: 0}, {x: -1, y: -1}, {x: 0, y: 2}, {x: -1, y: 2},
        ],
        "12": [
            {x: 0, y: 0}, {x: 1, y: 0}, {x: 1, y: 1}, {x: 0, y: -2}, {x: 1, y: -2},
        ],
        "23": [
            {x: 0, y: 0}, {x: 1, y: 0}, {x: 1, y: -1}, {x: 0, y: 2}, {x: 1, y: 2},
        ],
        "30": [
            {x: 0, y: 0}, {x: -1, y: 0}, {x: -1, y: 1}, {x: 0, y: -2}, {x: -1, y: -2},
        ],

        "10": [
            {x: 0, y: 0}, {x: 1, y: 0}, {x: 1, y: 1}, {x: 0, y: -2}, {x: 1, y: -2},
        ],
        "21": [
            {x: 0, y: 0}, {x: -1, y: 0}, {x: -1, y: -1}, {x: 0, y: 2}, {x: -1, y: 2},
        ],
        "32": [
            {x: 0, y: 0}, {x: -1, y: 0}, {x: -1, y: 1}, {x: 0, y: -2}, {x: -1, y: -2},
        ],
        "03": [
            {x: 0, y: 0}, {x: 1, y: 0}, {x: 1, y: -1}, {x: 0, y: 2}, {x: 1, y: 2},
        ],
        "02": [{x: 0, y: 0}, {x: 0, y: 1}, {x: 0, y: -1}],
        "20": [{x: 0, y: 0}, {x: 0, y: 1}, {x: 0, y: -1}],
        "13": [{x: 0, y: 0}, {x: 0, y: 1}, {x: 0, y: -1}],
        "31": [{x: 0, y: 0}, {x: 0, y: 1}, {x: 0, y: -1}],
    },

    "S": {
        "01": [
            {x: 0, y: 0}, {x: -1, y: 0}, {x: -1, y: -1}, {x: 0, y: 2}, {x: -1, y: 2},
        ],
        "12": [
            {x: 0, y: 0}, {x: 1, y: 0}, {x: 1, y: 1}, {x: 0, y: -2}, {x: 1, y: -2},
        ],
        "23": [
            {x: 0, y: 0}, {x: 1, y: 0}, {x: 1, y: -1}, {x: 0, y: 2}, {x: 1, y: 2},
        ],
        "30": [
            {x: 0, y: 0}, {x: -1, y: 0}, {x: -1, y: 1}, {x: 0, y: -2}, {x: -1, y: -2},
        ],

        "10": [
            {x: 0, y: 0}, {x: 1, y: 0}, {x: 1, y: 1}, {x: 0, y: -2}, {x: 1, y: -2},
        ],
        "21": [
            {x: 0, y: 0}, {x: -1, y: 0}, {x: -1, y: -1}, {x: 0, y: 2}, {x: -1, y: 2},
        ],
        "32": [
            {x: 0, y: 0}, {x: -1, y: 0}, {x: -1, y: 1}, {x: 0, y: -2}, {x: -1, y: -2},
        ],
        "03": [
            {x: 0, y: 0}, {x: 1, y: 0}, {x: 1, y: -1}, {x: 0, y: 2}, {x: 1, y: 2},
        ],
        "02": [{x: 0, y: 0}, {x: 0, y: 1}, {x: 0, y: -1}],
        "20": [{x: 0, y: 0}, {x: 0, y: 1}, {x: 0, y: -1}],
        "13": [{x: 0, y: 0}, {x: 0, y: 1}, {x: 0, y: -1}],
        "31": [{x: 0, y: 0}, {x: 0, y: 1}, {x: 0, y: -1}],

    },

    "T": {
        "01": [
            {x: 0, y: 0}, {x: -1, y: 0}, {x: -1, y: -1}, {x: 0, y: 2}, {x: -1, y: 2},
        ],
        "12": [
            {x: 0, y: 0}, {x: 1, y: 0}, {x: 1, y: 1}, {x: 0, y: -2}, {x: 1, y: -2},
        ],
        "23": [
            {x: 0, y: 0}, {x: 1, y: 0}, {x: 1, y: -1}, {x: 0, y: 2}, {x: 1, y: 2},
        ],
        "30": [
            {x: 0, y: 0}, {x: -1, y: 0}, {x: -1, y: 1}, {x: 0, y: -2}, {x: -1, y: -2},
        ],

        "10": [
            {x: 0, y: 0}, {x: 1, y: 0}, {x: 1, y: 1}, {x: 0, y: -2}, {x: 1, y: -2},
        ],
        "21": [
            {x: 0, y: 0}, {x: -1, y: 0}, {x: -1, y: -1}, {x: 0, y: 2}, {x: -1, y: 2},
        ],
        "32": [
            {x: 0, y: 0}, {x: -1, y: 0}, {x: -1, y: 1}, {x: 0, y: -2}, {x: -1, y: -2},
        ],
        "03": [
            {x: 0, y: 0}, {x: 1, y: 0}, {x: 1, y: -1}, {x: 0, y: 2}, {x: 1, y: 2},
        ],
        "02": [{x: 0, y: 0}, {x: 0, y: 1}, {x: 0, y: -1}],
        "20": [{x: 0, y: 0}, {x: 0, y: 1}, {x: 0, y: -1}],
        "13": [{x: 0, y: 0}, {x: 0, y: 1}, {x: 0, y: -1}],
        "31": [{x: 0, y: 0}, {x: 0, y: 1}, {x: 0, y: -1}],
    },

    "Z": {
        "01": [
            {x: 0, y: 0}, {x: -1, y: 0}, {x: -1, y: -1}, {x: 0, y: 2}, {x: -1, y: 2},
        ],
        "12": [
            {x: 0, y: 0}, {x: 1, y: 0}, {x: 1, y: 1}, {x: 0, y: -2}, {x: 1, y: -2},
        ],
        "23": [
            {x: 0, y: 0}, {x: 1, y: 0}, {x: 1, y: -1}, {x: 0, y: 2}, {x: 1, y: 2},
        ],
        "30": [
            {x: 0, y: 0}, {x: -1, y: 0}, {x: -1, y: 1}, {x: 0, y: -2}, {x: -1, y: -2},
        ],

        "10": [
            {x: 0, y: 0}, {x: 1, y: 0}, {x: 1, y: 1}, {x: 0, y: -2}, {x: 1, y: -2},
        ],
        "21": [
            {x: 0, y: 0}, {x: -1, y: 0}, {x: -1, y: -1}, {x: 0, y: 2}, {x: -1, y: 2},
        ],
        "32": [
            {x: 0, y: 0}, {x: -1, y: 0}, {x: -1, y: 1}, {x: 0, y: -2}, {x: -1, y: -2},
        ],
        "03": [
            {x: 0, y: 0}, {x: 1, y: 0}, {x: 1, y: -1}, {x: 0, y: 2}, {x: 1, y: 2},
        ],
        "02": [{x: 0, y: 0}, {x: 0, y: 1}, {x: 0, y: -1}],
        "20": [{x: 0, y: 0}, {x: 0, y: 1}, {x: 0, y: -1}],
        "13": [{x: 0, y: 0}, {x: 0, y: 1}, {x: 0, y: -1}],
        "31": [{x: 0, y: 0}, {x: 0, y: 1}, {x: 0, y: -1}],
    },


    "O": { // the O tetromino never kicks.
        "01": [{x: 0, y: 0}],
        "02": [{x: 0, y: 0}],
        "03": [{x: 0, y: 0}],
        "10": [{x: 0, y: 0}],
        "12": [{x: 0, y: 0}],
        "13": [{x: 0, y: 0}],
        "20": [{x: 0, y: 0}],
        "21": [{x: 0, y: 0}],
        "23": [{x: 0, y: 0}],
        "30": [{x: 0, y: 0}],
        "31": [{x: 0, y: 0}],
        "32": [{x: 0, y: 0}],
    },


};
